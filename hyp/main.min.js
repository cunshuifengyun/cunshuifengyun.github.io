var AssetAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?n(s):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var HttpCommand=function(){function t(){this.http_url="http://api.fx1q.com/",this.http_key="Vbu1WSodPL!4fNg3",this.http_head="Accept:application/vnd.qq5.v1+json;charset=UTF-8"}var e=(__define,t),i=e.prototype;return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},i.test=function(){var t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT;this.getString("");t.open("http://api.qq5.com/res/news",egret.HttpMethod.POST),t.setRequestHeader("Content-Type",this.http_head),t.send(),t.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),t.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},i.onGetComplete=function(t){console.log("postComplete"+t)},i.onGetIOError=function(t){var e=t.currentTarget.response;console.log("postError:"+t),console.log("postError:"+e.response),console.log("postError:"+t.data)},i.onGetProgress=function(t){console.log("postProgress"+t)},i.getString=function(t){var e=Base64Util.encode(t),i=Math.floor((new Date).getTime()/1e3).toString();return"&data="+e+"&time="+i+"&sign="+(new md5).hex_md5(e+i+this.http_url)+"&device_type=android&version=1.2.1"},t}();egret.registerClass(HttpCommand,"HttpCommand");var GlobalData=function(){function t(){}var e=(__define,t);e.prototype;return t.GameStage_width=640,t.GameStage_height=960,t.version=201605241700,t}();egret.registerClass(GlobalData,"GlobalData");var StringConst=function(){function t(){}var e=(__define,t);e.prototype;return t.String_00001="资源配置加载...",t.String_00002="该功能暂未开放！",t.String_00003="该功能暂未开放！",t}();egret.registerClass(StringConst,"StringConst");var UIConst=function(){function t(){}var e=(__define,t);e.prototype;return t.POP_MESSAGE_TYPE_TIPS=0,t.POP_MESSAGE_TYPE_WINDOW=1,t.POP_MESSAGE_TYPE_WINDOW_CANCEL=2,t.POP_MESSAGE_TYPE_WINDOW_NOPOPAGAIN=3,t}();egret.registerClass(UIConst,"UIConst");var MyUIEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n),this.data=null}__extends(e,t);var i=(__define,e);i.prototype;return e.LOGIN_IN="LOGIN_IN",e.CHANGE_CHAPTER="CHANGE_CHAPTER",e.OPEN_MISSION_LIST="OPEN_MISSION_LIST",e.UPDATE_MISSION_ITEM="UPDATE_MISSION_ITEM",e.CLOSE_MENU="CLOSE_MENU",e.LOAD_STORY_CHAPTER="LOAD_STORY_CHAPTER",e}(egret.Event);egret.registerClass(MyUIEvent,"MyUIEvent");var AVGManager=function(){function t(){}var e=(__define,t);e.prototype;return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t}();egret.registerClass(AVGManager,"AVGManager");var LoadManager=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},n.startLoad=function(t,e,i,n){void 0===n&&(n=!1),null==this.loading_view&&(this.loading_view=new LoadingInGameUI),UIManager.getInstance().loadingCon.addChild(this.loading_view),this.group_name=t,this.event_name=i,RES.createGroup(t,e,n),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup(t)},n.onResourceLoadComplete=function(t){t.groupName==this.group_name&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.dispatchComplete()),null!=this.loading_view&&null!=this.loading_view.parent&&(this.loading_view.clear(),this.loading_view.parent.removeChild(this.loading_view))},n.dispatchComplete=function(){var t=new MyUIEvent(this.event_name);t.data={groupname:this.group_name},this.dispatchEvent(t)},n.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},n.onResourceProgress=function(t){t.groupName==this.group_name&&null!=this.loading_view&&this.loading_view.setProgress(t.itemsLoaded,t.itemsTotal)},e}(egret.EventDispatcher);egret.registerClass(LoadManager,"LoadManager");var SoundManager=function(){function t(){this.bg_position=0,this.sound_switch=!0,this.sound_effect_switch=!0}var e=(__define,t),i=e.prototype;return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},i.playBgSound=function(t){this.sound_switch=t,t?(null==this.bgSound&&(this.bgSound=RES.getRes("bg_mp3")),null!=this.bgChannel&&(this.bgChannel.stop(),this.bgChannel=null),this.bgChannel=this.bgSound.play(this.bg_position,0)):null!=this.bgChannel?(this.bg_position=this.bgChannel.position,this.bgChannel.stop(),this.bgChannel=null):this.bg_position=0},i.setSoundEffectSwitch=function(t){this.sound_effect_switch=t},i.playEffectSound=function(t){if(void 0===t&&(t="sound_11_wav"),this.sound_effect_switch){var e=RES.getRes(t);if(console.log("音效文件："+t+":"+e),null!=e){var i=e.play(0,1),n={s:e,c:i},s=function(){this.c.stop(),this.c=null,this.s=null};i.addEventListener(egret.Event.SOUND_COMPLETE,s,n)}}},t}();egret.registerClass(SoundManager,"SoundManager");var TweenManager=function(){function t(){this.tween_ui_time=500}var e=(__define,t),i=e.prototype;return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},i.uiAppearTween=function(e,i,n,s,r){var a=egret.Tween.get(e),h=GlobalData.GameStage_width,o=GlobalData.GameStage_height,c=0,_=0;i==t.TWEEN_UI_MOVE?(e.anchorOffsetX=h/2,e.anchorOffsetY=o/2,0==n?(e.x=-h/2,e.y=o/2):1==n?(e.x=h/2,e.y=-o/2):2==n?(e.x=3*h/2,e.y=o/2):(e.x=h/2,e.y=3*o/2),null==s?a.to({x:h/2,y:o/2},this.tween_ui_time):a.to({x:h/2,y:o/2},this.tween_ui_time).call(s,r)):i==t.TWEEN_UI_SCALE?(0==n?(e.anchorOffsetX=h/2,e.anchorOffsetY=o/2,e.x=h/2,e.y=o/2,c=h/2,_=o/2):1==n?(e.anchorOffsetX=h,e.anchorOffsetY=0,e.x=2*h,e.y=-o,c=h,_=0):2==n?(e.anchorOffsetX=h,e.anchorOffsetY=o,e.x=2*h,e.y=2*o,c=h,_=o):3==n?(e.anchorOffsetX=0,e.anchorOffsetY=o,e.x=-h,e.y=2*o,c=0,_=o):(e.anchorOffsetX=0,e.anchorOffsetY=0,e.x=-h,e.y=-o,c=0,_=0),e.scaleX=e.scaleY=0,null==s?a.to({x:c,y:_,scaleX:1,scaleY:1},this.tween_ui_time):a.to({x:c,y:_,scaleX:1,scaleY:1},this.tween_ui_time).call(s,r)):i==t.TWEEN_UI_SCALE_ROTATION&&(e.alpha=0,null==s?a.to({alpha:1},this.tween_ui_time):a.to({alpha:1},this.tween_ui_time).call(s,r))},i.uiDisappearTween=function(e,i,n,s,r){var a=egret.Tween.get(e),h=GlobalData.GameStage_width,o=GlobalData.GameStage_height,c=0,_=0;i==t.TWEEN_UI_MOVE?(e.anchorOffsetX=h/2,e.anchorOffsetY=o/2,e.x=h/2,e.y=o/2,0==n?(c=3*h/2,_=o/2):1==n?(c=h/2,_=3*o/2):2==n?(c=-h/2,_=o/2):(c=h/2,_=-o/2),null==s?a.to({x:c,y:_},this.tween_ui_time):a.to({x:c,y:_},this.tween_ui_time).call(s,r)):i==t.TWEEN_UI_SCALE?null==s?a.to({alpha:0},this.tween_ui_time):a.to({alpha:0},this.tween_ui_time).call(s,r):i==t.TWEEN_UI_SCALE_ROTATION&&(0==n?(c=h,_=-o):1==n?(c=h,_=o):2==n?(c=-h,_=o):(c=-h,_=-o),null==s?a.to({x:c,y:_,scaleX:.01,scaleY:.01,rotation:720},this.tween_ui_time):a.to({x:c,y:_,scaleX:.01,scaleY:.01,rotation:720},this.tween_ui_time).call(s,r))},i.uiSecondDisappearTween=function(e,i,n,s,r){var a=egret.Tween.get(e),h=GlobalData.GameStage_width,o=GlobalData.GameStage_height,c=0,_=0;i==t.TWEEN_UI_MOVE?(e.anchorOffsetX=h/2,e.anchorOffsetY=o/2,e.x=h/2,e.y=o/2,0==n?(c=-h/2,_=o/2):1==n?(c=h/2,_=-o/2):2==n?(c=3*h/2,_=o/2):(c=h/2,_=3*o/2),null==s?a.to({x:c,y:_},this.tween_ui_time):a.to({x:c,y:_},this.tween_ui_time).call(s,r)):i==t.TWEEN_UI_SCALE?a.to({scaleX:0,scaleY:0},this.tween_ui_time).call(s,r):i==t.TWEEN_UI_SCALE_ROTATION&&(0==n?(c=h,_=-o):1==n?(c=h,_=o):2==n?(c=-h,_=o):(c=-h,_=-o),a.to({x:c,y:_,scaleX:.01,scaleY:.01,rotation:720},this.tween_ui_time).call(s,r))},t.TWEEN_UI_RANDOM=-1,t.TWEEN_UI_NONE=0,t.TWEEN_UI_MOVE=1,t.TWEEN_UI_SCALE=2,t.TWEEN_UI_SCALE_ROTATION=3,t}();egret.registerClass(TweenManager,"TweenManager");var UIManager=function(t){function e(){t.call(this),this.ui_class_arr=null,this.second_tween_type=0,this.second_tween_sub_type=0}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},n.startGame=function(){this.initUIClass(),this.mainCon=new egret.DisplayObjectContainer,this.secondCon=new egret.DisplayObjectContainer,this.broadcastCon=new egret.DisplayObjectContainer,this.storyCon=new egret.DisplayObjectContainer,this.loadingCon=new egret.DisplayObjectContainer,null!=GlobalData.GameStage&&(GlobalData.GameStage.addChild(this.mainCon),GlobalData.GameStage.addChild(this.secondCon),GlobalData.GameStage.addChild(this.broadcastCon),GlobalData.GameStage.addChild(this.storyCon),GlobalData.GameStage.addChild(this.loadingCon),this.openFirstUI(e.CLASS_UI_INDEX_LOGOANIMATION))},n.initUIClass=function(){this.ui_class_arr=[LogoAnimation,LoginMain,StoryUI]},n.openFirstUI=function(t,e){if(void 0===e&&(e=0),this.is_ui_tween)return void console.log("正在打开界面，禁止操作");for(this.is_ui_tween=!0;this.mainCon.numChildren>1;)this.mainCon.removeChildAt(0);if(e==TweenManager.TWEEN_UI_RANDOM&&(e=Math.floor(3*Math.random())+1),console.log("缓动动画类型："+e),0==this.mainCon.numChildren)this.realOpenFirst(t,e);else{var i=Math.ceil(5*Math.random()),n=this.mainCon.getChildAt(0);TweenManager.getInstance().uiDisappearTween(n,e,i,null,this),this.realOpenFirst(t,e,i)}},n.realOpenFirst=function(t,e,i){if(void 0===i&&(i=0),null!=this.ui_class_arr[t]){var n=new this.ui_class_arr[t];e==TweenManager.TWEEN_UI_NONE?this.openFirstUIFinish():(this.openFirstUIFinish.bind(this),TweenManager.getInstance().uiAppearTween(n,e,i,this.openFirstUIFinish,this)),this.mainCon.addChild(n)}else console.log("ui索引错误")},n.openFirstUIFinish=function(){for(;this.mainCon.numChildren>1;)this.mainCon.removeChildAt(0);this.is_ui_tween=!1},n.openSecondUI=function(t,e){return void 0===e&&(e=0),this.is_ui_tween?void console.log("正在打开界面，禁止操作"):(this.is_ui_tween=!0,e==TweenManager.TWEEN_UI_RANDOM&&(e=Math.floor(3*Math.random())+1),this.second_tween_type=e,this.second_tween_sub_type=Math.ceil(5*Math.random()),void(null!=t?(e==TweenManager.TWEEN_UI_NONE?this.openSecondUIFinish():(this.openSecondUIFinish.bind(this),TweenManager.getInstance().uiAppearTween(t,this.second_tween_type,this.second_tween_sub_type,this.openSecondUIFinish,this)),this.secondCon.addChild(t)):console.log("二级界面不存在")))},n.openSecondUIFinish=function(){this.is_ui_tween=!1},n.closeSecondFinish=function(){this.secondCon.numChildren>0&&this.secondCon.removeChildAt(this.secondCon.numChildren-1),this.is_ui_tween=!1},n.closeSecondUI=function(){return this.is_ui_tween?void console.log("正在打开界面，禁止操作"):(this.is_ui_tween=!0,void(this.secondCon.numChildren>0&&TweenManager.getInstance().uiSecondDisappearTween(this.secondCon.getChildAt(this.secondCon.numChildren-1),this.second_tween_type,this.second_tween_sub_type,this.closeSecondFinish,this)))},n.popMessage=function(t,e){void 0===e&&(e=1),console.log(t)},e.CLASS_UI_INDEX_LOGOANIMATION=0,e.CLASS_UI_INDEX_LOGINMAIN=1,e.CLASS_UI_INDEX_STORY=2,e.CLASS_UI_INDEX_FIGHT=3,e}(egret.EventDispatcher);egret.registerClass(UIManager,"UIManager");var Base64Util=function(){function t(){}var e=(__define,t);e.prototype;return t.encode=function(t){var e=new egret.ByteArray;return e.writeUTFBytes(t),this.encodeByteArray(e)},t.encodeByteArray=function(t){var e,i="",n=new Array(4);for(t.position=0;t.bytesAvailable>0;){e=new Array;for(var s=0;3>s&&t.bytesAvailable>0;s++)e[s]=t.readUnsignedByte();n[0]=(252&e[0])>>2,n[1]=(3&e[0])<<4|e[1]>>4,n[2]=(15&e[1])<<2|e[2]>>6,n[3]=63&e[2];for(var r=e.length;3>r;r++)n[r+1]=64;for(var a=0;a<n.length;a++)i+=this.BASE64_CHARS.charAt(n[a])}return i},t.decode=function(t){var e=this.decodeToByteArray(t);return e.readUTFBytes(e.length)},t.decodeToByteArray=function(t){for(var e=new egret.ByteArray,i=new Array(4),n=new Array(3),s=0;s<t.length;s+=4){for(var r=0;4>r&&s+r<t.length;r++)i[r]=this.BASE64_CHARS.indexOf(t.charAt(s+r));n[0]=(i[0]<<2)+((48&i[1])>>4),n[1]=((15&i[1])<<4)+((60&i[2])>>2),n[2]=((3&i[2])<<6)+i[3];for(var a=0;a<n.length&&64!=i[a+1];a++)e.writeByte(n[a])}return e.position=0,e},t.BASE64_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t.version="1.0.0",t}();egret.registerClass(Base64Util,"Base64Util");var FilterUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.getGrayFilter=function(){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);return[e]},t.getBlurFilter=function(){var t=new egret.BlurFilter(1,1);return[t]},t}();egret.registerClass(FilterUtil,"FilterUtil");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}var e=(__define,t),i=e.prototype;return i.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},i.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},i.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},i.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},i.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},i.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},i.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},i.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},i.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),s=Array(16),r=0;16>r;r++)n[r]=909522486^i[r],s[r]=1549556828^i[r];var a=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(s.concat(a),640))},i.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",s="",r=0;r<t.length;r++)i=t.charCodeAt(r),s+=n.charAt(i>>>4&15)+n.charAt(15&i);return s},i.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",s=t.length,r=0;s>r;r+=3)for(var a=t.charCodeAt(r)<<16|(s>r+1?t.charCodeAt(r+1)<<8:0)|(s>r+2?t.charCodeAt(r+2):0),h=0;4>h;h++)n+=8*r+6*h>8*t.length?this.b64pad:i.charAt(a>>>6*(3-h)&63);return n},i.rstr2any=function(t,e){var i,n,s,r,a,h=e.length,o=Array(Math.ceil(t.length/2));for(i=0;i<o.length;i++)o[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),_=Array(c);for(n=0;c>n;n++){for(a=Array(),r=0,i=0;i<o.length;i++)r=(r<<16)+o[i],s=Math.floor(r/h),r-=s*h,(a.length>0||s>0)&&(a[a.length]=s);_[n]=r,o=a}var l="";for(i=_.length-1;i>=0;i--)l+=e.charAt(_[i]);return l},i.str2rstr_utf8=function(t){for(var e,i,n="",s=-1;++s<t.length;)e=t.charCodeAt(s),i=s+1<t.length?t.charCodeAt(s+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),s++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},i.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},i.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},i.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},i.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},i.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,s=-1732584194,r=271733878,a=0;a<t.length;a+=16){var h=i,o=n,c=s,_=r;i=this.md5_ff(i,n,s,r,t[a+0],7,-680876936),r=this.md5_ff(r,i,n,s,t[a+1],12,-389564586),s=this.md5_ff(s,r,i,n,t[a+2],17,606105819),n=this.md5_ff(n,s,r,i,t[a+3],22,-1044525330),i=this.md5_ff(i,n,s,r,t[a+4],7,-176418897),r=this.md5_ff(r,i,n,s,t[a+5],12,1200080426),s=this.md5_ff(s,r,i,n,t[a+6],17,-1473231341),n=this.md5_ff(n,s,r,i,t[a+7],22,-45705983),i=this.md5_ff(i,n,s,r,t[a+8],7,1770035416),r=this.md5_ff(r,i,n,s,t[a+9],12,-1958414417),s=this.md5_ff(s,r,i,n,t[a+10],17,-42063),n=this.md5_ff(n,s,r,i,t[a+11],22,-1990404162),i=this.md5_ff(i,n,s,r,t[a+12],7,1804603682),r=this.md5_ff(r,i,n,s,t[a+13],12,-40341101),s=this.md5_ff(s,r,i,n,t[a+14],17,-1502002290),n=this.md5_ff(n,s,r,i,t[a+15],22,1236535329),i=this.md5_gg(i,n,s,r,t[a+1],5,-165796510),r=this.md5_gg(r,i,n,s,t[a+6],9,-1069501632),s=this.md5_gg(s,r,i,n,t[a+11],14,643717713),n=this.md5_gg(n,s,r,i,t[a+0],20,-373897302),i=this.md5_gg(i,n,s,r,t[a+5],5,-701558691),r=this.md5_gg(r,i,n,s,t[a+10],9,38016083),s=this.md5_gg(s,r,i,n,t[a+15],14,-660478335),n=this.md5_gg(n,s,r,i,t[a+4],20,-405537848),i=this.md5_gg(i,n,s,r,t[a+9],5,568446438),r=this.md5_gg(r,i,n,s,t[a+14],9,-1019803690),s=this.md5_gg(s,r,i,n,t[a+3],14,-187363961),n=this.md5_gg(n,s,r,i,t[a+8],20,1163531501),i=this.md5_gg(i,n,s,r,t[a+13],5,-1444681467),r=this.md5_gg(r,i,n,s,t[a+2],9,-51403784),s=this.md5_gg(s,r,i,n,t[a+7],14,1735328473),n=this.md5_gg(n,s,r,i,t[a+12],20,-1926607734),i=this.md5_hh(i,n,s,r,t[a+5],4,-378558),r=this.md5_hh(r,i,n,s,t[a+8],11,-2022574463),s=this.md5_hh(s,r,i,n,t[a+11],16,1839030562),n=this.md5_hh(n,s,r,i,t[a+14],23,-35309556),i=this.md5_hh(i,n,s,r,t[a+1],4,-1530992060),r=this.md5_hh(r,i,n,s,t[a+4],11,1272893353),s=this.md5_hh(s,r,i,n,t[a+7],16,-155497632),n=this.md5_hh(n,s,r,i,t[a+10],23,-1094730640),i=this.md5_hh(i,n,s,r,t[a+13],4,681279174),r=this.md5_hh(r,i,n,s,t[a+0],11,-358537222),s=this.md5_hh(s,r,i,n,t[a+3],16,-722521979),n=this.md5_hh(n,s,r,i,t[a+6],23,76029189),i=this.md5_hh(i,n,s,r,t[a+9],4,-640364487),r=this.md5_hh(r,i,n,s,t[a+12],11,-421815835),s=this.md5_hh(s,r,i,n,t[a+15],16,530742520),n=this.md5_hh(n,s,r,i,t[a+2],23,-995338651),i=this.md5_ii(i,n,s,r,t[a+0],6,-198630844),r=this.md5_ii(r,i,n,s,t[a+7],10,1126891415),s=this.md5_ii(s,r,i,n,t[a+14],15,-1416354905),n=this.md5_ii(n,s,r,i,t[a+5],21,-57434055),i=this.md5_ii(i,n,s,r,t[a+12],6,1700485571),r=this.md5_ii(r,i,n,s,t[a+3],10,-1894986606),s=this.md5_ii(s,r,i,n,t[a+10],15,-1051523),n=this.md5_ii(n,s,r,i,t[a+1],21,-2054922799),i=this.md5_ii(i,n,s,r,t[a+8],6,1873313359),r=this.md5_ii(r,i,n,s,t[a+15],10,-30611744),s=this.md5_ii(s,r,i,n,t[a+6],15,-1560198380),n=this.md5_ii(n,s,r,i,t[a+13],21,1309151649),i=this.md5_ii(i,n,s,r,t[a+4],6,-145523070),r=this.md5_ii(r,i,n,s,t[a+11],10,-1120210379),s=this.md5_ii(s,r,i,n,t[a+2],15,718787259),n=this.md5_ii(n,s,r,i,t[a+9],21,-343485551),i=this.safe_add(i,h),n=this.safe_add(n,o),s=this.safe_add(s,c),r=this.safe_add(r,_)}return[i,n,s,r]},i.md5_cmn=function(t,e,i,n,s,r){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,r)),s),i)},i.md5_ff=function(t,e,i,n,s,r,a){return this.md5_cmn(e&i|~e&n,t,e,s,r,a)},i.md5_gg=function(t,e,i,n,s,r,a){return this.md5_cmn(e&n|i&~n,t,e,s,r,a)},i.md5_hh=function(t,e,i,n,s,r,a){return this.md5_cmn(e^i^n,t,e,s,r,a)},i.md5_ii=function(t,e,i,n,s,r,a){return this.md5_cmn(i^(e|~n),t,e,s,r,a)},i.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},i.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();egret.registerClass(md5,"md5");var ViewUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.setCenter=function(t){t.x=(GlobalData.GameStage.stageWidth-t.width)/2,t.y=(GlobalData.GameStage.stageHeight-t.height)/2},t.getShape=function(t,e,i,n){void 0===t&&(t=640),void 0===e&&(e=960),void 0===i&&(i=0),void 0===n&&(n=.7);var s=new egret.Shape;return s.graphics.beginFill(i,n),s.graphics.drawRect(0,0,t,e),s.graphics.endFill(),s.touchEnabled=!1,s},t.getArtNum=function(t,e){for(var i=new egret.Sprite,n=0;n<e.length;){var s=RES.getRes(t+e.charAt(n)),r=new egret.Bitmap(s);r.x=i.width+1,r.y=-s.textureHeight/2,i.addChild(r)}return i},t.hitTest=function(t,e){var i=t.getBounds(),n=e.getBounds();return i.x=t.x,i.y=t.y,n.x=e.x,n.y=e.y,i.intersects(n)},t}();egret.registerClass(ViewUtil,"ViewUtil");var BaseButton=function(t){function e(e){t.call(this),this.src_str=e,this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.bg=new egret.Sprite,this.addChild(this.bg);var t=RES.getRes(this.src_str);this.src=new egret.Bitmap(t),this.bg.addChild(this.src)},n.startTween=function(){var t=this.bg.y,e=egret.Tween.get(this.bg,{loop:!0});e.to({y:this.bg.y+20},500).to({y:t},500).wait(100)},n.clear=function(){egret.Tween.removeTweens(this.bg),this.removeChildren(),this.src_str=null,this.src=null},e}(eui.Group);egret.registerClass(BaseButton,"BaseButton");var BaseFirstUI=function(t){function e(){t.call(this),this.addChild(ViewUtil.getShape(GlobalData.GameStage_width,GlobalData.GameStage_height,0,0)),this.anchorOffsetX=GlobalData.GameStage_width/2,this.anchorOffsetY=GlobalData.GameStage_height/2,this.verticalCenter=this.horizontalCenter=0}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(BaseFirstUI,"BaseFirstUI");var BasePopUI=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(BasePopUI,"BasePopUI");var BaseSecondUI=function(t){function e(){t.call(this),this.anchorOffsetX=GlobalData.GameStage_width/2,this.anchorOffsetY=GlobalData.GameStage_height/2}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(BaseSecondUI,"BaseSecondUI");var MyProgressBar=function(t){function e(e,i,n){t.call(this),this.skinName=e,this.bar_width_min=i,this.bar_width_max=n}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setBarMinMax=function(t,e){this.bar_width_min=t,this.bar_width_max=e},n.childrenCreated=function(){this.reset()},n.reset=function(){this.progress_txt.text="",this.progress_bar.width=this.bar_width_min,this.progress_bar.mask=this.progress_bar_mask,this.current_value=0,this.current_max=0},n.setText=function(t){this.progress_txt.text=t},n.setProgress=function(t,e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),i){this.target_value=t,this.target_max=e,egret.Tween.removeTweens(this.progress_bar),egret.Tween.removeTweens(this);var s=egret.Tween.get(this.progress_bar),r=egret.Tween.get(this,{onChange:this.updateText,onChangeObj:this}),a=1100-100*Math.ceil(10*this.current_value/this.current_max);if(n)s.to({width:this.bar_width_max},a).call(this.levelUp,this),r.to({current_value:this.current_max},a).call(this.txtTweenPause,this);else{var h=t/e*this.bar_width_max+this.bar_width_min;s.to({width:h},a),r.to({current_value:this.target_value},a)}}else this.setText(t+" / "+e),this.progress_bar.width=t/e*this.bar_width_max+this.bar_width_min,this.current_value=t,this.current_max=e},n.levelUp=function(){this.progress_bar.width=this.bar_width_min,this.current_max=this.target_max,egret.Tween.removeTweens(this.progress_bar);var t=egret.Tween.get(this.progress_bar),e=100*Math.ceil(10*this.target_value/this.target_max),i=this.target_value/this.target_max*this.bar_width_max+this.bar_width_min;t.to({width:i},e)},n.txtTweenPause=function(){egret.Tween.removeTweens(this);var t=egret.Tween.get(this,{onChange:this.updateText,onChangeObj:this});this.current_max=this.target_max,this.current_value=0;var e=100*Math.ceil(10*this.target_value/this.target_max);t.to({current_value:this.target_value},e)},n.updateText=function(){this.current_value=Math.ceil(this.current_value),this.setText(this.current_value+" / "+this.current_max)},n.tweenFinish=function(){this.current_value=this.target_value,this.current_max=this.target_max,this.setText(this.current_value+" / "+this.current_max)},n.clear=function(){egret.Tween.removeTweens(this.progress_bar),egret.Tween.removeTweens(this),this.progress_txt=null,this.progress_bar=null,this.progress_bar_mask=null},e}(eui.Component);egret.registerClass(MyProgressBar,"MyProgressBar");var LoadingInGameUI=function(t){function e(){t.call(this),this.bar_width_min=50,this.bar_width_max=338,this.skinName="resource/assets/skins/LoadingSkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){this.reset()},n.reset=function(){this.progress_txt.text="",this.progress_bar.width=this.bar_width_min,this.progress_bar.mask=this.progress_bar_mask},n.setText=function(t){},n.setProgress=function(t,e){this.progress_bar.width=t/e*this.bar_width_max,this.progress_txt.text="资源加载中..."+t+"/"+e},n.clear=function(){this.reset()},e}(eui.Component);egret.registerClass(LoadingInGameUI,"LoadingInGameUI");var LoadingUI=function(t){function e(){t.call(this),this.bar_width_min=50,this.bar_width_max=338,this.skinName="resource/assets/skins/LoadingSkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){this.reset()},n.reset=function(){this.progress_txt.text="",this.progress_bar.width=this.bar_width_min,this.progress_bar.mask=this.progress_bar_mask},n.setText=function(t){},n.setProgress=function(t,e){this.progress_bar.width=t/e*this.bar_width_max+this.bar_width_min,this.progress_txt.text="资源加载中..."+t+"/"+e},n.clear=function(){},e}(eui.Component);egret.registerClass(LoadingUI,"LoadingUI");var PreLoadUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createView=function(){this.bg=new egret.Bitmap,this.bg.texture=RES.getRes("logo_png"),this.addChild(this.bg),ViewUtil.setCenter(this.bg)},e}(egret.Sprite);egret.registerClass(PreLoadUI,"PreLoadUI");var LoginMain=function(t){function e(){t.call(this),this.skinName="resource/assets/skins/LoginMainSkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createChildren=function(){t.prototype.createChildren.call(this),this.btn=new StartButton("startgame_png"),this.addChild(this.btn),this.btn.startTween(),this.btn.once(egret.TouchEvent.TOUCH_TAP,this.click,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},n.click=function(t){StoryLogic.getInstance().openStory()},n.clear=function(){null!=this.btn.parent&&this.btn.parent.removeChild(this.btn),this.btn.clear(),this.btn=null},e}(eui.Component);egret.registerClass(LoginMain,"LoginMain");var StartButton=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createChildren=function(){t.prototype.createChildren.call(this),this.anchorOffsetX=this.bg.width/2,this.anchorOffsetY=this.bg.height,this.bottom=50,this.horizontalCenter=0},e}(BaseButton);egret.registerClass(StartButton,"StartButton");var LogoAnimation=function(t){function e(){t.call(this),this.skinName="resource/assets/skins/LogoAnimationSkin.exml",this.init(),this.once(egret.Event.ADDED_TO_STAGE,this.onStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.addChild(ViewUtil.getShape(GlobalData.GameStage_width,GlobalData.GameStage_height,8947848,.2)),this.logo.anchorOffsetX=this.logo.width/2,this.logo.anchorOffsetY=this.logo.height/2,this.logo.x=this.width/2,this.logo.y=0,this.logo_txt.alpha=0,this.logo.scaleX=this.logo.scaleY=.1},n.onStage=function(t){var e=egret.Tween.get(this.logo);e.to({y:GlobalData.GameStage_height/2-100,scaleX:1,scaleY:1},500,egret.Ease.backInOut).call(this.txtTween,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this)},n.txtTween=function(){var t=egret.Tween.get(this.logo_txt);t.to({alpha:1},500).wait(100).call(this.clear,this)},n.clear=function(){UIManager.getInstance().openFirstUI(UIManager.CLASS_UI_INDEX_LOGINMAIN)},n.removeStage=function(t){},e}(eui.Component);egret.registerClass(LogoAnimation,"LogoAnimation");var MenuUI=function(t){function e(){t.call(this),this.skinName="MainMenuSkin"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.back_btn=new BaseButton("menubtnbg_png"),this.back_btn.x=0,this.back_btn.y=-30;var e=new egret.Bitmap(RES.getRes("fanhui_png"));e.x=(this.back_btn.bg.width-e.width)/2,e.y=238,this.back_btn.bg.addChild(e),this.addChild(this.back_btn),this.back_btn.startTween();var i=egret.Tween.get(this.shop_bg,{loop:!0});i.to({rotation:this.rotation+1e3},3e3),this.expbar.setBarMinMax(22,238),this.expbar.setProgress(700,1e3),this.buy_prop_btn_arr=[];for(var n=0;4>n;n++)this["prop"+(n+1)].addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBuyProp,this);this.update_wall_btn_arr=[],this.initEvent()},n.initEvent=function(){this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.shop_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShop,this),this.setting_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSetting,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},n.clickSetting=function(){SoundManager.getInstance().playEffectSound(),UIManager.getInstance().openSecondUI(new SettingUI,TweenManager.TWEEN_UI_MOVE)},n.clickShop=function(){SoundManager.getInstance().playEffectSound(),UIManager.getInstance().openSecondUI(new ShopUI,TweenManager.TWEEN_UI_SCALE)},n.clickBack=function(t){SoundManager.getInstance().playEffectSound();var e=egret.Tween.get(this);e.to({x:-this.width},300).call(this.tweenFinish,this)},n.tweenFinish=function(){null!=this.parent&&(this.parent.removeChild(this),StoryLogic.getInstance().dispatchEvent(new MyUIEvent(MyUIEvent.CLOSE_MENU)))},n.clickBuyProp=function(t){SoundManager.getInstance().playEffectSound()},n.clickUpdateWall=function(t){SoundManager.getInstance().playEffectSound()},n.clear=function(t){this.back_btn.clear(),this.back_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this);for(var e=0;e<this.buy_prop_btn_arr.length;e++)this.buy_prop_btn_arr[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBuyProp,this),this.buy_prop_btn_arr[e]=null;for(var e=0;e<this.update_wall_btn_arr.length;e++)this.update_wall_btn_arr[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickUpdateWall,this),this.update_wall_btn_arr[e]=null;egret.Tween.removeTweens(this.shop_bg),this.expbar.clear(),this.back_btn=null,this.shop_bg=null,this.shop_btn=null,this.expbar=null,this.role_lv=null,this.role_atk=null,this.help_btn=null,this.coint_txt=null,this.setting_btn=null,this.buy_prop_btn_arr=null,this.prop_num_arr=null,this.update_wall_btn_arr=null,this.wall_lv_arr=null,this.wall_select=null},e}(BasePopUI);egret.registerClass(MenuUI,"MenuUI");var SettingUI=function(t){function e(){t.call(this),this.skinName="resource/assets/skins/SettingSkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.back_btn=new BaseButton("goback_btn_png"),this.back_btn.anchorOffsetX=this.back_btn.bg.width/2,this.back_btn.x=GlobalData.GameStage_width/2,this.back_btn.y=this.bg.y+this.bg.height-this.back_btn.bg.height/2,this.addChild(this.back_btn),this.back_btn.startTween(),this.sound_close.visible=!SoundManager.getInstance().sound_switch,this.sound_eff_close.visible=!SoundManager.getInstance().sound_effect_switch,this.initEvent()},n.initEvent=function(){this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.sound_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSoundSwitch,this),this.sound_eff_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSoundEffectSwitch,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.clear,this)
},n.clickSoundSwitch=function(){SoundManager.getInstance().playBgSound(!SoundManager.getInstance().sound_switch),this.sound_close.visible=!SoundManager.getInstance().sound_switch,SoundManager.getInstance().playEffectSound()},n.clickSoundEffectSwitch=function(){SoundManager.getInstance().setSoundEffectSwitch(!SoundManager.getInstance().sound_effect_switch),this.sound_eff_close.visible=!SoundManager.getInstance().sound_effect_switch,SoundManager.getInstance().playEffectSound()},n.clickBack=function(){SoundManager.getInstance().playEffectSound(),UIManager.getInstance().closeSecondUI()},n.clear=function(){this.back_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.sound_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSoundSwitch,this),this.sound_eff_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickSoundEffectSwitch,this)},e}(BaseSecondUI);egret.registerClass(SettingUI,"SettingUI");var ShopUI=function(t){function e(){t.call(this),this.skinName="resource/assets/skins/ShopSkin.exml"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.back_btn=new BaseButton("goback_btn_png"),this.back_btn.anchorOffsetX=this.back_btn.bg.width/2,this.back_btn.x=GlobalData.GameStage_width/2,this.back_btn.y=GlobalData.GameStage_height-300,this.addChild(this.back_btn),this.back_btn.startTween(),this.initEvent()},n.initEvent=function(){this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},n.clickBack=function(){SoundManager.getInstance().playEffectSound(),UIManager.getInstance().closeSecondUI()},n.clear=function(){this.back_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this)},e}(BaseSecondUI);egret.registerClass(ShopUI,"ShopUI");var PopWindow=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Component);egret.registerClass(PopWindow,"PopWindow");var ChapterSelect=function(t){function e(){t.call(this),this.skinName="ChapterSelectSkin",this.horizontalCenter=0,this.top=60,this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.chapter_arr=[this.chapter1,this.chapter2,this.chapter3,this.chapter4],this.chapter1.filters=this.chapter2.filters=FilterUtil.getGrayFilter()},n.setSelect=function(t){},e}(eui.Component);egret.registerClass(ChapterSelect,"ChapterSelect");var ChapterSelectUI=function(t){function e(){t.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onStage=function(){this.current_chapter_num=StoryLogic.getInstance().current_chapterID,this.totol_chapter_num=StoryLogic.getInstance().chapter_data.length,this.head=new eui.Image("mainchapter_btn"),this.addChild(this.head),this.current_chapter_img=new eui.Image("main"+(this.current_chapter_num-1)),this.current_chapter_img.touchEnabled=!1,this.current_chapter_img.x=(this.head.width-40)/2,this.current_chapter_img.y=8,this.addChild(this.current_chapter_img),this.select_ui=new eui.Component,this.select_ui.skinName="ChapterSelectSkin",this.select_ui.horizontalCenter=0,this.select_ui.top=60,this.select_ui.scaleY=0,this.list_visible=!1,this.addChildAt(this.select_ui,0),this.chapter_arr=[],this.selected_broad_img=this.select_ui.getChildByName("chapter_select");for(var t=0;t<this.totol_chapter_num;t++){var e=this.select_ui.getChildByName("chapter"+(t+1));this.chapter_arr.push(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectChapter,this),t+1>this.current_chapter_num&&(e.filters=FilterUtil.getGrayFilter())}this.setSelectedY(),this.head.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickChapter,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},n.setSelectedY=function(){this.selected_broad_img.y=8+60*(this.current_chapter_num-1),null!=this.current_chapter_img&&null!=this.current_chapter_img.parent&&(this.current_chapter_img.parent.removeChild(this.current_chapter_img),this.current_chapter_img=null),this.current_chapter_img=new eui.Image("main"+(this.current_chapter_num-1)),this.current_chapter_img.touchEnabled=!1,this.current_chapter_img.x=(this.head.width-40)/2,this.current_chapter_img.y=8,this.addChild(this.current_chapter_img)},n.selectChapter=function(t){var e=parseInt(t.currentTarget.name.slice(7));if(this.current_chapter_num!=e&&!this.is_tween)if(e<=StoryLogic.getInstance().current_chapterID){this.current_chapter_num=e,this.setSelectedY();var i=new MyUIEvent(MyUIEvent.CHANGE_CHAPTER);i.data={id:e},StoryLogic.getInstance().dispatchEvent(i)}else console.log("先把前面的章节打通吧")},n.changeChapter=function(){this.is_tween=!1,this.list_visible=!1},n.clickChapter=function(t){if(SoundManager.getInstance().playEffectSound(),!this.is_tween){var e=egret.Tween.get(this.select_ui);this.is_tween=!0,this.list_visible?e.to({scaleY:0},100).call(this.tweenFinish,this):e.to({scaleY:1},100).call(this.tweenFinish,this)}},n.tweenFinish=function(){this.is_tween=!1,this.list_visible=!this.list_visible},n.setTween=function(t){this.is_tween=t},n.clear=function(t){for(var e;e<this.chapter_arr.length;e++)this.chapter_arr[e].filters=null,this.chapter_arr[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.selectChapter,this);egret.Tween.removeTweens(this.select_ui),this.removeChildren(),this.head.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickChapter,this),this.head=null,this.current_chapter_img=null,this.select_ui=null,this.selected_broad_img=null,this.chapter_arr=null},e}(eui.Component);egret.registerClass(ChapterSelectUI,"ChapterSelectUI");var ChapterUI=function(t){function e(e){t.call(this),this.chapter_id=e,this.once(egret.Event.ADDED_TO_STAGE,this.onStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onStage=function(){this.mission_data=StoryLogic.getInstance().chapter_data[this.chapter_id-1],this.mission_num=this.mission_data.length/3-1,this.current_mission=this.chapter_id==StoryLogic.getInstance().current_chapterID?Math.ceil(StoryLogic.getInstance().current_missionID/StoryLogic.MISSION_LIST_NUM)-1:999,this.mission_btn_arr=[];var t=RES.getRes("story_"+this.chapter_id+"_jpg");this.addChild(new egret.Bitmap(t));for(var e=0;e<this.mission_num;e++){var i=e<this.current_mission?StoryLogic.MISSION_STATE_FINISH:e==this.current_mission?StoryLogic.MISSION_STATE_WANTED:StoryLogic.MISSION_STATE_LOCK,n=new MissionBtn(e,this.mission_data[3*e+2],i);n.x=this.mission_data[3*e],n.y=this.mission_data[3*e+1],this.addChild(n),this.mission_btn_arr.push(n)}this.more_btn=new BaseButton("mainmoregame_btn"),this.more_btn.anchorOffsetX=this.more_btn.bg.width/2,this.more_btn.anchorOffsetY=this.more_btn.bg.height/2,this.more_btn.x=this.mission_data[3*this.mission_num],this.more_btn.y=this.mission_data[3*this.mission_num+1],this.addChild(this.more_btn),this.more_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMoreGame,this)},n.clickMoreGame=function(t){SoundManager.getInstance().playEffectSound(),UIManager.getInstance().popMessage(StringConst.String_00002,UIConst.POP_MESSAGE_TYPE_WINDOW)},n.clear=function(){this.more_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMoreGame,this),this.removeChildren(),this.more_btn=null,this.mission_btn_arr=null,this.mission_data=null},e}(eui.Group);egret.registerClass(ChapterUI,"ChapterUI");var MissionBtn=function(t){function e(e,i,n){void 0===n&&(n=0),t.call(this),this.mission_id=e,this.btn_width=i,this.state=n,this.anchorOffsetX=i/2,this.anchorOffsetY=i/2,this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){if(this.bg_circle=new egret.Bitmap(RES.getRes("btnbg_png")),this.tween_circle=new egret.Bitmap(RES.getRes("btnbg_png")),this.lock_bmp=new egret.Bitmap(RES.getRes("mainsuo")),this.bg_circle.smoothing=this.tween_circle.smoothing=this.lock_bmp.smoothing=!0,this.bg_circle.anchorOffsetX=this.bg_circle.anchorOffsetY=this.bg_circle.width/2,this.tween_circle.anchorOffsetX=this.tween_circle.anchorOffsetY=this.tween_circle.width/2,this.lock_bmp.anchorOffsetX=this.lock_bmp.anchorOffsetY=this.lock_bmp.width/2,this.bg_circle.x=this.bg_circle.y=this.lock_bmp.x=this.tween_circle.x=this.tween_circle.y=this.btn_width/2,this.lock_bmp.y=this.btn_width/2+10,this.addChild(this.bg_circle),this.addChild(this.tween_circle),this.addChild(this.lock_bmp),this.state==StoryLogic.MISSION_STATE_LOCK)this.tween_circle.visible=!1,this.bg_circle.scaleX=this.bg_circle.scaleY=(this.btn_width-40)/this.bg_circle.width,this.lock_bmp.scaleX=this.lock_bmp.scaleY=(this.btn_width-70)/this.lock_bmp.width;else if(this.state==StoryLogic.MISSION_STATE_WANTED){this.lock_bmp.visible=!1,this.bg_circle.scaleX=this.bg_circle.scaleY=(this.btn_width+30)/this.bg_circle.width;var t=(this.btn_width+0)/this.tween_circle.width,e=(this.btn_width-20)/this.tween_circle.width;this.tween_circle.scaleX=this.tween_circle.scaleY=t,null==this.tw&&(this.tw=egret.Tween.get(this.tween_circle,{loop:!0})),this.tw.to({scaleX:e,scaleY:e},800).to({scaleX:t,scaleY:t},800)}else this.lock_bmp.visible=!1,this.tween_circle.visible=!1,this.bg_circle.alpha=0;this.once(egret.Event.REMOVED_FROM_STAGE,this.clear,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this)},n.clickMission=function(t){if(this.state!=StoryLogic.MISSION_STATE_LOCK){var e=new MyUIEvent(MyUIEvent.OPEN_MISSION_LIST);e.data=this.mission_id,StoryLogic.getInstance().dispatchEvent(e)}},n.clear=function(){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this),egret.Tween.removeTweens(this.tween_circle),this.removeChildren(),this.bg_circle=null,this.tween_circle=null,this.lock_bmp=null},e}(eui.Group);egret.registerClass(MissionBtn,"MissionBtn");var MissionItem=function(t){function e(e,i,n){t.call(this),this.mission_id=e,this.src_str="listli_bg"+(Math.ceil(e/15)-1)+(n==StoryLogic.MISSION_ITEM_STATE_LOCK?"n":"");var s=RES.getRes(this.src_str);this.bg=new eui.Image(s),this.addChild(this.bg),this.star=new eui.Group,this.star.horizontalCenter=0,this.star.top=s.textureHeight+18,this.addChild(this.star),this.width_set=s.textureWidth,this.height_set=s.textureHeight+40,this.bg_height=s.textureHeight,this.changeState(n,i)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.changeState=function(t,e){if(this.state=t,t==StoryLogic.MISSION_ITEM_STATE_LOCK){var i=RES.getRes("mainsuo");this.lock=new eui.Image(i),this.lock.x=(this.width_set-i.textureWidth)/2,this.lock.y=(this.bg_height-i.textureHeight)/2,this.addChild(this.lock)}else t==StoryLogic.MISSION_ITEM_STATE_WANTED?(this.addNumImage(),this.changeStar(0)):(this.addNumImage(),this.changeStar(e))},n.addNumImage=function(){if(null==this.mission_id_img||null==this.mission_id_img.parent){var t=new eui.Label;t.text=this.mission_id.toString(),t.x=(this.width_set-t.width)/2,t.y=(this.bg_height-t.height)/2,this.addChild(t)}},n.changeStar=function(t){this.star.removeChildren();for(var e=0;3>e;e++){var i=RES.getRes(t>e?"listli_starl":"listli_stara"),n=new eui.Image(i);n.anchorOffsetY=i.textureHeight/2,n.x=35*e,this.star.addChild(n)}},n.clear=function(){this.star.removeChildren(),this.bg=null,this.star=null,this.lock=null,this.mission_id_img=null},e}(eui.Group);egret.registerClass(MissionItem,"MissionItem");var MissionUI=function(t){function e(e,i){t.call(this),this.charter_id=e,this.mission_index=i,this.skinName="resource/assets/skins/MissionListSkin.exml",this.once(egret.Event.ADDED_TO_STAGE,this.onStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onStage=function(t){this.newest_mission_id=StoryLogic.getInstance().current_missionID;var e=ViewUtil.getShape(GlobalData.GameStage_width,GlobalData.GameStage_height,0,.7);this.addChildAt(e,0);var i=RES.getRes("listgk"+this.mission_index);this.mission_id_img=new eui.Image(i),this.mission_id_img.anchorOffsetY=i.textureHeight/2,this.mission_id_img.x=345,this.mission_id_img.y=100+this.title_bg.height/2,this.addChild(this.mission_id_img),this.mission_list_con=new eui.Group,this.mission_list_con.horizontalCenter=0,this.mission_list_con.top=200,this.addChild(this.mission_list_con),this.mission_arr=[];for(var n=0;n<StoryLogic.MISSION_LIST_NUM;n++){var s=this.mission_index*StoryLogic.MISSION_LIST_NUM+(n+1),r=n%4,a=this.getState(n),h=new MissionItem(s,r,a);h.name=s.toString(),h.x=(h.width_set+60)*(n%3),h.y=(h.height_set+10)*Math.floor(n/3),a==StoryLogic.MISSION_ITEM_STATE_WANTED&&(this.current_mission_item=h),this.mission_list_con.addChild(h),this.mission_arr.push(h),h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickItem,this)}null!=this.current_mission_item&&this.addCurrentHand(),this.initEvent()},n.addCurrentHand=function(){if(null==this.finger){var t=RES.getRes("finger_png");this.finger=new eui.Image(t),this.finger.anchorOffsetX=t.textureWidth/2,this.finger.anchorOffsetY=t.textureHeight/2,this.finger.scaleX=this.finger.scaleY=.7,this.finger.smoothing=!0}this.finger.x=this.current_mission_item.x+this.current_mission_item.width_set+100,this.finger.y=this.current_mission_item.y+this.current_mission_item.height_set-34+this.mission_list_con.top,this.addChild(this.finger);var e=egret.Tween.get(this.finger,{loop:!0});e.to({scaleX:.5,scaleY:.5},400).to({scaleX:.7,scaleY:.7},400)},n.getState=function(t){if(this.charter_id<StoryLogic.getInstance().current_chapterID)return StoryLogic.MISSION_ITEM_STATE_FINISH;var e=Math.floor((this.newest_mission_id-1)/StoryLogic.MISSION_LIST_NUM);return this.mission_index<e?StoryLogic.MISSION_ITEM_STATE_FINISH:this.mission_index==e?t<(this.newest_mission_id-1)%15?StoryLogic.MISSION_ITEM_STATE_FINISH:t==(this.newest_mission_id-1)%15?StoryLogic.MISSION_ITEM_STATE_WANTED:StoryLogic.MISSION_ITEM_STATE_LOCK:StoryLogic.MISSION_ITEM_STATE_LOCK},n.initEvent=function(){this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),StoryLogic.getInstance().addEventListener(MyUIEvent.UPDATE_MISSION_ITEM,this.updateMissionItem,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},n.updateMissionItem=function(t){null!=this.click_mission_item&&this.click_mission_item.changeState(StoryLogic.MISSION_ITEM_STATE_WANTED,3)},n.clickBack=function(t){SoundManager.getInstance().playEffectSound(),null!=this.parent&&this.parent.removeChild(this)},n.clickItem=function(t){SoundManager.getInstance().playEffectSound(),this.click_mission_item=t.currentTarget;var e=parseInt(t.currentTarget.name);t.currentTarget.state==StoryLogic.MISSION_ITEM_STATE_LOCK?console.log("点击第"+this.charter_id+"章节 第"+(this.mission_index+1)+"关卡 第"+e+"小关此关卡还没开通"):console.log("点击第"+this.charter_id+"章节 第"+(this.mission_index+1)+"关卡 第"+e+"小关")},n.clear=function(t){this.removeChildren(),this.back_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),StoryLogic.getInstance().removeEventListener(MyUIEvent.UPDATE_MISSION_ITEM,this.updateMissionItem,this);for(var e;e<this.mission_arr.length;e++)this.mission_arr[e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickItem,this);this.back_btn=null,this.mission_id_img=null,this.title_bg=null,this.mission_arr=null},e}(eui.Component);egret.registerClass(MissionUI,"MissionUI");var StoryLogic=function(t){function e(){t.call(this),this.chapter_data=[[493,352,220,237,448,200,451,613,220,177,642,0],[493,352,220,237,448,200,451,613,220,177,642,0],[493,352,220,237,448,200,451,613,220,177,642,0],[493,352,220,237,448,200,451,613,220,177,642,0]]}__extends(e,t);var i=(__define,e),n=i.prototype;return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},n.openStory=function(){this.current_chapterID=3,this.current_missionID=18,this.openUI()},n.openUI=function(){UIManager.getInstance().openFirstUI(UIManager.CLASS_UI_INDEX_STORY,TweenManager.TWEEN_UI_MOVE)},e.MISSION_STATE_LOCK=0,e.MISSION_STATE_WANTED=1,e.MISSION_STATE_FINISH=2,e.MISSION_ITEM_STATE_LOCK=0,e.MISSION_ITEM_STATE_WANTED=1,e.MISSION_ITEM_STATE_FINISH=2,e.MISSION_LIST_NUM=15,e}(egret.EventDispatcher);egret.registerClass(StoryLogic,"StoryLogic");var StoryUI=function(t){function e(){t.call(this),this.chapter_id=-1,this.once(egret.Event.ADDED_TO_STAGE,this.onStage,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onStage=function(t){this.new_chapter_id=StoryLogic.getInstance().current_chapterID,this.chapter_select=new ChapterSelectUI,this.chapter_select.y=75,this.addChild(this.chapter_select),this.menu_btn=new BaseButton("menubtnbg_png");var e=new egret.Bitmap(RES.getRes("caidan_png"));e.x=(this.menu_btn.bg.width-e.width)/2,e.y=238,this.menu_btn.bg.addChild(e),this.menu_btn.anchorOffsetX=this.menu_btn.bg.width/2,this.menu_btn.x=GlobalData.GameStage_width/2,this.menu_btn.y=GlobalData.GameStage_height-this.menu_btn.bg.height,this.addChild(this.menu_btn),this.menu_btn.startTween(),this.initEvent(),this.loadChapter(),SoundManager.getInstance().playBgSound(SoundManager.getInstance().sound_switch)},n.loadChapter=function(){var t=("story_"+this.new_chapter_id,["story_"+this.new_chapter_id+"_jpg"]);LoadManager.getInstance().startLoad("story"+this.new_chapter_id,t,MyUIEvent.LOAD_STORY_CHAPTER)},n.initChapter=function(t){if(t.data.groupname=="story"+this.new_chapter_id)if(this.new_chapter_ui=new ChapterUI(this.new_chapter_id),null==this.chapter_ui)this.chapter_ui=this.new_chapter_ui,this.chapter_id=this.new_chapter_id,this.addChildAt(this.chapter_ui,0),this.new_chapter_ui=null;else{this.chapter_select.setTween(!0),this.addChildAt(this.new_chapter_ui,0);var e,i=egret.Tween.get(this.chapter_ui),n=egret.Tween.get(this.new_chapter_ui);this.new_chapter_id<this.chapter_id?(this.new_chapter_ui.x=-GlobalData.GameStage_width,e=GlobalData.GameStage_width):(this.new_chapter_ui.x=GlobalData.GameStage_width,e=-GlobalData.GameStage_width),i.to({x:e},500),n.to({x:0},500).call(this.tweenFinish,this)}},n.tweenFinish=function(){null!=this.chapter_ui&&null!=this.chapter_ui.parent&&(this.chapter_ui.parent.removeChild(this.chapter_ui),this.chapter_ui=null),this.chapter_ui=this.new_chapter_ui,this.chapter_id=this.new_chapter_id,this.new_chapter_ui=null,this.chapter_select.setTween(!1)},n.initEvent=function(){this.menu_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMenu,this),StoryLogic.getInstance().addEventListener(MyUIEvent.OPEN_MISSION_LIST,this.openMission,this),StoryLogic.getInstance().addEventListener(MyUIEvent.CHANGE_CHAPTER,this.changeChapter,this),StoryLogic.getInstance().addEventListener(MyUIEvent.CLOSE_MENU,this.closeMenu,this),LoadManager.getInstance().addEventListener(MyUIEvent.LOAD_STORY_CHAPTER,this.initChapter,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},n.openMission=function(t){SoundManager.getInstance().playEffectSound();var e=new MissionUI(this.chapter_id,t.data);this.addChild(e)},n.changeChapter=function(t){SoundManager.getInstance().playEffectSound(),this.new_chapter_id=t.data.id,this.loadChapter()},n.clickMenu=function(t){if(SoundManager.getInstance().playEffectSound(),!this.is_tween){this.is_tween=!0;var e=egret.Tween.get(this.menu_btn);e.to({x:-GlobalData.GameStage_width/2},300).call(this.openMenu,this)}},n.openMenu=function(){this.is_tween=!1,null==this.menu&&(this.menu=new MenuUI),this.addChild(this.menu),this.menu.x=-GlobalData.GameStage_width/2;var t=egret.Tween.get(this.menu);t.to({x:0},300)},n.closeMenu=function(){this.menu=null,this.is_tween=!0;var t=egret.Tween.get(this.menu_btn);t.to({x:GlobalData.GameStage_width/2},300).call(this.menuBtnAppear,this)},n.menuBtnAppear=function(){this.is_tween=!1},n.clear=function(){this.menu_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMenu,this),StoryLogic.getInstance().removeEventListener(MyUIEvent.OPEN_MISSION_LIST,this.openMission,this),StoryLogic.getInstance().removeEventListener(MyUIEvent.CHANGE_CHAPTER,this.changeChapter,this),StoryLogic.getInstance().removeEventListener(MyUIEvent.CLOSE_MENU,this.closeMenu,this),LoadManager.getInstance().removeEventListener(MyUIEvent.LOAD_STORY_CHAPTER,this.initChapter,this),egret.Tween.removeAllTweens(),this.removeChildren(),this.chapter_select=null,this.menu_btn.clear(),this.menu_btn=null,this.menu=null},e}(BaseFirstUI);egret.registerClass(StoryUI,"StoryUI");var Main=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createChildren=function(){t.prototype.createChildren.call(this),this.init();var e=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",e),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.init=function(){GlobalData.GameStage=this.stage,GlobalData.GameStage_width=this.stage.stageWidth,GlobalData.GameStage_height=this.stage.stageHeight},n.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},n.onThemeLoadComplete=function(){this.theme.removeEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.loadGroup("loading")},n.onResourceLoadComplete=function(t){"preload"==t.groupName?(this.preloadView=new PreLoadUI,this.addChild(this.preloadView),this.theme=new eui.Theme("resource/default.thm.json",this.stage),this.theme.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)):"loading"==t.groupName?(this.removeChild(this.preloadView),this.loadingView=new LoadingUI,this.addChild(this.loadingView),ViewUtil.setCenter(this.loadingView),this.loadingView.setText("加载登录界面..."),RES.loadGroup("game")):"game"==t.groupName&&(this.contains(this.loadingView)&&(this.removeChild(this.loadingView),this.loadingView.clear()),UIManager.getInstance().startGame(),this.clear())},n.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},n.onResourceProgress=function(t){"game"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},n.clear=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.preloadView=null,this.loadingView=null,this.theme=null},e}(eui.UILayer);egret.registerClass(Main,"Main");var ThemeAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);